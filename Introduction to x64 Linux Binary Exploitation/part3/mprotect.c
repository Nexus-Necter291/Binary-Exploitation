#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <signal.h>
#include <sys/mman.h>

void greet_me();

int main(int argc, char const *argv[])
{
    int pagesize = sysconf(_SC_PAGESIZE);
    printf("pagesize = %d\n", pagesize);

    if (mprotect(0x00007ffffffdd000, pagesize, 7) == 0)
    {
        printf("[!] Operation Successfull !\n");
        printf("[!] Memory region : 0x00007ffffffdd000 to 0x0000%lx has been set to r-w-x.\n", 0x00007ffffffdd000 + pagesize);
    }

    else
        printf("[!] Operation Failed !\n");

    greet_me();
    return 0;
}

void greet_me()
{
    char name[200];
    printf("Enter your name here : ");
    gets(name);
    printf("Hi there %s\n", name);
}