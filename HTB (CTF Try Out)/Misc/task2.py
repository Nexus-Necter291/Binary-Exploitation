from pwn import *

# Define the mapping of scenarios to responses
response_mapping = {
    'GORGE': 'STOP',
    'FIRE': 'ROLL',
    'PHREAK': 'DROP'
}

# Create a remote connection to the game server
IP = '94.237.54.201'
PORT = 58928

pros = remote(IP, PORT)
pros.sendline(b'y\n')
# Read the welcome message
pros.recvuntil(b"Let's go!\n")

try:
    while True:
        # Receive the scenario line
        scenario_line = pros.recvline().strip().decode('utf-8')
        
        # Check if the line contains scenarios or if it's the ending message
        if "What do you do?" in scenario_line:
            # This means we received a prompt for our response, so we need to process it
            scenarios = scenario_line.split(", ") if ", " in scenario_line else []

            # Generate the response based on the mapping
            responses = [response_mapping[scenario] for scenario in scenarios]
            final_response = "-".join(responses)

            # Send the response back to the server
            pros.sendline(final_response.encode('utf-8'))

        elif "Unfortunate!" in scenario_line:
            break  # Exit the loop on game over

except Exception as e:
    # Optionally handle other exceptions (like connection issues)
    pass
finally:
    pros.close()
