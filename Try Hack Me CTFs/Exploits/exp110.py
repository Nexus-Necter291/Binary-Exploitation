SELECT 
    AspNetUsers.Email AS EmailId,
    SpikoCourse.CourseTitle AS CourseName 
FROM 
    SpikoStudent 
JOIN 
    SpikoStudentSection ON SpikoStudent.StudentId = SpikoStudentSection.StudentId 
JOIN 
    SpikoSection ON SpikoStudentSection.SectionId = SpikoSection.Id 
JOIN 
    SpikoCourse ON SpikoSection.CourseId = SpikoCourse.CourseId 
JOIN 
    AspNetUsers ON AspNetUsers.Id = SpikoStudent.UserId 
LEFT JOIN 
    SpikoAssignmentSubmission ON SpikoStudent.StudentId = SpikoAssignmentSubmission.StudentId 
WHERE SpikoStudentSection.EnrolledOn IS NOT NULL AND SpikoAssignmentSubmission.StudentId IS NULL;
